<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sds.webapp.stm.dao.ProfitDAO">
	<select id="findByKey" parameterType="ProfitDomain" resultType="ProfitDomain"
		useCache="true">
		select
		ID,ORDER_ID,ACCOUNT,AMOUNT,TOTAL_PROFIT,AGENT_ID,AGENT_PROFIT,TJ_PROFIT,TJ_ID,ORDER_DATE,JS_DATE,CREATE_DATE
		from fm_profit
		<where>
			<if test="id !=null">
				and ID = #{id}
			</if>
		</where>
	</select>
	<select id="findByWhere" parameterType="ProfitDomain"
		resultType="ProfitDomain" useCache="true">
		SELECT
		a.ID,
		a.ORDER_ID,
		a.ACCOUNT,
		a.AMOUNT,
		a.TOTAL_PROFIT,
		a.AGENT_ID,
		b.full_name as AGENT_NAME,
		a.AGENT_PROFIT,
		a.TJ_PROFIT,
		a.TJ_ID,
		a.ORDER_DATE,
		a.JS_DATE,
		a.CREATE_DATE
		FROM
		fm_profit a LEFT JOIN fm_user
		b
		ON a.agent_id = b.id
		<where>
			<if test="id !=null">
				and a.ID = #{id}
			</if>
			<if test="orderId !=null">
				and a.ORDER_ID = #{orderId}
			</if>
			<if test="account !=null">
				and a.ACCOUNT = #{account}
			</if>
			<if test="amount !=null">
				and a.AMOUNT = #{amount}
			</if>
			<if test="totalProfit !=null">
				and a.TOTAL_PROFIT = #{totalProfit}
			</if>
			<if test="agentId !=null">
				and a.AGENT_ID = #{agentId}
			</if>
			<if test="agentProfit !=null">
				and a.AGENT_PROFIT = #{agentProfit}
			</if>
			<if test="tjProfit !=null">
				and a.TJ_PROFIT = #{tjProfit}
			</if>
			<if test="tjId !=null">
				and a.TJ_ID = #{tjId}
			</if>
			<if test="orderDate !=null">
				and a.ORDER_DATE = #{orderDate}
			</if>
			<if test="jsDate !=null">
				and a.JS_DATE = #{jsDate}
			</if>
			<if test="createDate !=null">
				and a.CREATE_DATE = #{createDate}
			</if>
		</where>
	</select>
	<insert id="insert" parameterType="ProfitDomain" flushCache="true">
		insert into
		fm_profit(ID,ORDER_ID,ACCOUNT,AMOUNT,MERCHANT_PROFIT,TOTAL_PROFIT,AGENT_ID,AGENT_PROFIT,TJ_PROFIT,TJ_ID,ORDER_DATE,JS_DATE,CREATE_DATE,STATUS)
		values
		(#{id},#{orderId},#{account},#{amount},#{merchantProfit},#{totalProfit},#{agentId},#{agentProfit},#{tjProfit},#{tjId},#{orderDate},#{jsDate},#{createDate},#{status})
	</insert>
	<update id="update" parameterType="ProfitDomain" flushCache="true">
		update fm_profit
		<set>
			<if test="orderId !=null">
				ORDER_ID = #{orderId},
			</if>
			<if test="account !=null">
				ACCOUNT = #{account},
			</if>
			<if test="amount !=null">
				AMOUNT = #{amount},
			</if>
			<if test="totalProfit !=null">
				TOTAL_PROFIT = #{totalProfit},
			</if>
			<if test="agentId !=null">
				AGENT_ID = #{agentId},
			</if>
			<if test="agentProfit !=null">
				AGENT_PROFIT = #{agentProfit},
			</if>
			<if test="tjProfit !=null">
				TJ_PROFIT = #{tjProfit},
			</if>
			<if test="tjId !=null">
				TJ_ID = #{tjId},
			</if>
			<if test="orderDate !=null">
				ORDER_DATE = #{orderDate},
			</if>
			<if test="jsDate !=null">
				JS_DATE = #{jsDate},
			</if>
			<if test="createDate !=null">
				CREATE_DATE = #{createDate},
			</if>
		</set>
		<where>

			ID = #{id}

		</where>
	</update>
	<delete id="delete" parameterType="ProfitDomain" flushCache="true">
		delete from fm_profit
		<where>

			ID = #{id}

		</where>
	</delete>

	<select id="getAllProfit" parameterType="ProfitDomain"
		resultType="ProfitDomain" useCache="true">
		select
		ID,ORDER_ID,ACCOUNT,AMOUNT,TOTAL_PROFIT,AGENT_ID,AGENT_PROFIT,TJ_PROFIT,TJ_ID,ORDER_DATE,JS_DATE,CREATE_DATE
		from fm_profit
		<where>
			<if test="id !=null">
				and ID = #{id}
			</if>
			<if test="orderId !=null">
				and ORDER_ID = #{orderId}
			</if>
			<if test="account !=null">
				and ACCOUNT = #{account}
			</if>
			<if test="amount !=null">
				and AMOUNT = #{amount}
			</if>
			<if test="totalProfit !=null">
				and TOTAL_PROFIT = #{totalProfit}
			</if>
			<if test="agentId !=null">
				and AGENT_ID = #{agentId}
			</if>
			<if test="agentProfit !=null">
				and AGENT_PROFIT = #{agentProfit}
			</if>
			<if test="tjProfit !=null">
				and TJ_PROFIT = #{tjProfit}
			</if>
			<if test="tjId !=null">
				and TJ_ID = #{tjId}
			</if>
			<if test="orderDate !=null">
				and DATE_FORMAT(ORDER_DATE, '%Y-%m-%d') =
				DATE_FORMAT(#{orderDate}, '%Y-%m-%d')
			</if>
			<if test="jsDate !=null">
				and JS_DATE = #{jsDate}
			</if>
			<if test="createDate !=null">
				and CREATE_DATE = #{createDate}
			</if>
			and STATUS = 1
		</where>
	</select>


	<update id="profitCountComplete" parameterType="ProfitDomain"
		flushCache="true">
		update fm_profit
		<set>
			status = 2
		</set>
		<where>
			ID = #{id}
		</where>
	</update>
</mapper>